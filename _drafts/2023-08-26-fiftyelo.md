---
layout: post
title: "One line of code cost me 10% of my matches"
date: 2023-08-26 15:29:00 -0500
tags: rust, chess
---

Sometimes, I make mistakes so puny that I feel like a moron for making them, yet so destructive that
I feel like an idiot for not fixing them.

My long-running slow-burn side project is
[Fiddler, a chess engine](https://github.com/claytonwramsey/fiddler).
The [last time]({% post-url 2023-06-19 fiddler-const-magic %}) I wrote about it, I wrote about 300
lines of code to get a 6 Elo improvement, equivalent to a 1% improvement to its match performance.
This time, I'm writing about a more recent development, when I edited one line of code to get a 50
Elo improvement, for about a 10% improvement in match performance.

To avoid clickbaiting you, here's the line in question.

```rust
if best_score >= beta { BoundType::Upper } else { BoundType::Lower }
```

However, for a full explanation as to why, you'll have to read the rest of this post.

## Learning to sing the alpha-beta

Our story begins with the foundational algorithm of all classical chess engines: alpha-beta search.
It's a trivial improvement to
